{% extends "layout.html" %}

{% block main %}

{% from 'macros.html' import pagination %}

<div id="coreexp-list-page" class="container ">

    <ul class="nav nav-pills pull-left">
        <li {% if request.args.channel == 'open' %}class="active"{% endif %}>
            <a href="javascript:change_param('channel', 'open')">开放</a>
        </li>
        <li {% if request.args.channel == 'closed' %}class="active"{% endif %}>
            <a href="javascript:change_param('channel', 'closed')">已关闭</a>
        </li>
        <li {% if request.args.channel == 'all' or not request.args.channel %}class="active"{% endif %}>
            <a href="javascript:change_param('channel', 'all')">全部</a>
        </li>
    </ul>

    <div class="pull-right">{{ pagination( pager.current, pager.total ) }}</div>
    <table class="table">
        <thead>
            <tr>
                <th style="width:150px">单词</th>
                <th>结果</th>
            </tr>
        </thead>
        <tbody>
            {% for ce in ce_list %}
            <tr>
                <td class="en">
                    <h3>{{ce.en}}</h3><br/>
                    <a href="javascript:"
                       data-id="{{ce._id}}"
                       data-tag="{% if 'closed' in ce.tags %}closed{% endif %}"
                       class="btn open">
                        {% if 'closed' in ce.tags %}已关闭{% else %}开放中{% endif %}
                    </a>
                </td>
                <td>
                    <ul class="unstyled">
                    {% for option in ce.ordered_options %}
                        <li>
                            <span class="label label-warning {{option.tag}}">{{option.voters | length }}</span>
                            <p class="answer">
                                {{option.cn}}
                                <a href="javascript:" {% if option.tag == 'best' %} class="tagged" {% endif %}
                                   data-option="{{option.cn}}" data-tag="best" data-id="{{ce._id}}">最佳</a>
                                <a href="javascript:" {% if option.tag == 'bad' %} class="tagged" {% endif %}
                                   data-option="{{option.cn}}" data-tag="bad" data-id="{{ce._id}}">最差</a>
                                <a href="javascript:"
                                data-option="{{option.cn}}" data-tag="" data-id="{{ce._id}}">None</a>
                            </p><br/>
                            <p class="voters">【{{option.editor}}】{{option.voters | join(', ')}}</p>
                        </li>
                    {% endfor %}
                    </ul>
                    <p class="skippers">{{ce.skippers | join(', ')}}</p>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="pull-right">{{ pagination( pager.current, pager.total ) }}</div>

</div><!--/.container-->

{% endblock %}


{% block bottom %}
<script type="text/javascript" src="/static/js/coreexp-list.js"></script>
{% endblock %}